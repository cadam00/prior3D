<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to prior3D • prior3D</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to prior3D">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prior3D</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="GitHub"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cadam00/prior3D/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to prior3D</h1>
                        <h4 data-toc-skip class="author">Aggeliki Doxa,
Christos Adam, Nikolaos Nagkoulis, Antonios Mazaris, Stelios
Katsanevakis</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cadam00/prior3D/blob/HEAD/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<p><strong>This research was conducted at the Department of Marine
Sciences, University of the Aegean, Greece, supported by the European
Union’s Horizon 2020 research and innovation programme
HORIZON-CL6–2021-BIODIV-01–12, under grant agreement No 101059407,
“MarinePlan – Improved transdisciplinary science for effective
ecosystem-based maritime spatial planning and conservation in European
Seas”.</strong></p>
<div class="section level2">
<h2 id="introduction-to-the-prior3d-package-tutorial">1 <strong>Introduction to the prior3D Package
(tutorial)</strong><a class="anchor" aria-label="anchor" href="#introduction-to-the-prior3d-package-tutorial"></a>
</h2>
<p>The <strong>prior3D</strong> package offers a comprehensive toolset
for 3D systematic conservation planning, conducting nested
prioritization analyses across multiple depth levels and ensuring
efficient resource allocation throughout the water column (<a href="#ref-doxa20224d">Doxa et al. 2022</a>). It provides a structured
workflow designed to address biodiversity conservation and management
challenges in the 3 dimensions, such as the incorporation of multiple
costs at different depth levels, while facilitating users’ choices and
parameterization. The process initiates from the deepest level and
progressively moves toward the surface, by conducting a step-by-step
prioritization analysis at each depth Figure <a href="#fig-Figure1">1</a>. The optimization result at each depth level
is considered as a cost layer for the layer above. This approach gives
priority to areas chosen in deeper waters when selecting areas at the
subsequent upper level, thus creating a cascading prioritization
structure. The <strong>prior3D</strong> package is built upon the
<strong>prioritizr</strong> package (<a href="#ref-prioritizr">Hanson et
al. 2024</a>), using commercial and open-source exact algorithm solvers
that ensure optimal solutions to prioritization problems.</p>
<p align="center">
<img src="fig1.jpg" alt="Figure 1: Flow chart of the 3D prioritization analysis for the four depth
  zones considered in the @doxa20224d analysis" width="100%"></p>
<p class="caption" align="center">
<span id="fig-Figure1"></span>Figure 1: Flow chart of the 3D
prioritization analysis for the four depth zones considered in the Doxa
et al. (<a href="#ref-doxa20224d">2022</a>) analysis
</p>
<p>This tutorial will guide you through the key functions of the
package, from data preparation to generating informative outputs to
address conservation challenges in diverse marine (and terrestrial)
ecosystems and enable informed decision-making in biodiversity
conservation, restoration and management.</p>
</div>
<div class="section level2">
<h2 id="workflow-running-the-analysis">2 <strong>Workflow: Running the analysis</strong><a class="anchor" aria-label="anchor" href="#workflow-running-the-analysis"></a>
</h2>
<p>The package provides two options for conducting analyses:</p>
<ol style="list-style-type: decimal">
<li><p>Running a Step-by-Step 3D SCP analysis</p></li>
<li><p>Running a Comparative Analysis of a 2D and a 3D SCP
approach</p></li>
</ol>
<p>When opting for the step-by-step analysis (first option), the
workflow proceeds as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Use the <code><a href="../reference/split_rast.html">split_rast()</a></code> function to convert 2D
distribution rasters of biodiversity features into a 3D format.</p></li>
<li><p>Use the <code><a href="../reference/prioritize_3D.html">prioritize_3D()</a></code> function to set the
optimization problem and define its parameters. This function also
solves the problem and provides the solution in the form of a
map.</p></li>
<li><p>Use the <code><a href="../reference/evaluate_3D.html">evaluate_3D()</a></code> function to obtain detailed
results in a tabular format.</p></li>
<li><p>Use the <code><a href="../reference/plot_3D.html">plot_3D()</a></code> function to generate graphs based
on the solution results.</p></li>
</ol>
<p>When opting for a comparative analysis of a 2D and a 3D SCP approach
(second option), users can use the <code><a href="../reference/Compare_2D_3D.html">Compare_2D_3D()</a></code>
function. This function incorporates the aforementioned detailed
workflow and applies it to both 2D and 3D approaches, streamlining and
simplifying the analysis process for users. By using this function,
users provide the input data, define the optimization problem and its
parameterization, run the analysis and finally obtain the results in the
form of maps, graphs and tables.</p>
<p>The <strong>spatial coherence</strong> of the solution maps can be
evaluated through a post-processing analysis, which can be conducted
after either the step-by-step or the comparative analysis. The necessary
functions for this assessment are also provided within the package.</p>
</div>
<div class="section level2">
<h2 id="illustration-example">3 <strong>Illustration example</strong><a class="anchor" aria-label="anchor" href="#illustration-example"></a>
</h2>
<p>Let us consider the following dataset as an illustrative example. It
represents a subset of the species analyzed in Doxa et al. (<a href="#ref-doxa20224d">2022</a>). For simplicity reasons, we have
included only 20 species for demonstration purposes.</p>
<p><strong>Biodiversity features</strong></p>
<p>Two types of input data are needed for the biodiversity features.</p>
<ol style="list-style-type: decimal">
<li><p>Species information tables in tabular form
(<code>data.frame</code>). The first <code>data.frame</code> contains
information about the features. If the biodiversity features concern
species then this data.frame must indicate at least the species name and
species classification as pelagic or benthic (mandatory). Additional
optional data may include species assignment to prioritization groups
and, if available, the species’ bathymetric range (min and max depth at
which the species occurs). The second <code>data.frame</code> is a
prioritization weights table, where users can assign specific weights to
different prioritization groups. These groups can represent any
meaningful categorization for the prioritization process, like
taxonomical, functional, or conservation status categories, such as
those defined by the IUCN.</p></li>
<li><p>Biodiversity distribution data in 2D raster form. These rasters
contain the information on the spatial distribution of the features
across the study area. Biodiversity distribution information can
represent either presence-absence data (binary) or any continuous
information, such as biomass/abundance, probability of
occurrences.</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import prior3D R package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cadam00/prior3D" class="external-link">prior3D</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species information table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">biodiv_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">biodiv_df</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##               species_name pelagic min_z max_z</span></span>
<span><span class="co">## 1   acanthocybium_solandri       1   -20     0</span></span>
<span><span class="co">## 2    acantholabrus_palloni       0  -500   -30</span></span>
<span><span class="co">## 3 acanthomysis_longicornis       0  -100    -2</span></span>
<span><span class="co">## 4      abraliopsis_morisii       0 -3660     0</span></span>
<span><span class="co">## 5          abralia_veranyi       0  -900    -1</span></span>
<span><span class="co">## 6     abraliopsis_pfefferi       0  -750    -1</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Biodiversity distribution data in 2D raster form</span></span>
<span><span class="va">biodiv_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_biodiv_raster.html">get_biodiv_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">biodiv_raster</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 31, 83, 20  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.5, 0.5  (x, y)</span></span>
<span><span class="co">## extent      : -5.5, 36, 30.5, 46  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">## source      : biodiv_raster.tif </span></span>
<span><span class="co">## names       : aapto~aptos, abiet~etina, abra_alba, abral~ranyi, abral~risii, abral~fferi, ... </span></span>
<span><span class="co">## min values  :        0.01,        0.01,      0.01,        0.01,        0.01,        0.01, ... </span></span>
<span><span class="co">## max values  :        1.00,        0.63,      1.00,        1.00,        1.00,        1.00, ... </span></span></code></pre></div>
<p><strong>Planning site, planning units and depth levels</strong></p>
<p>In the illustration example, we consider as our planning site the
Mediterranean Sea, with 0.5°x0.5° cells as our planning unites (PUs). We
consider four depth levels: (i) 0 to 40 m (infralittoral zone, extending
to the lower limit of photophilic algae and seagrasses), (ii) 40 to 200
m (circalittoral zone, continental shelf, animal-dominated), (iii) 200
to 2000 m (~continental slope), and (iv) exceeding 2000 m in depth
(lower bathyal plains and abyssal zone) (Figure <a href="#fig-Figure2">2</a>).</p>
<p align="center">
<img src="fig2.jpg" alt="Figure 2: The study area and the considered depth zones" width="50%"></p>
<p class="caption" align="center">
<span id="fig-Figure2"></span>Figure 2: The study area and the
considered depth zones
</p>
<p>To conduct the analysis, a SpatRaster object containing bathymetric
data for the planning site is needed. This raster should represent
depths with negative values and match the extent and resolution of the
biodiversity rasters. Alternatively, if bathymetry maps of greater
resolution and broader extent are available, they can also be used, as
the prior3D functions internally conduct cropping and resampling to
match the biodiversity data. Producing the final depth raster that
delineates the desired depth zones is also produced by the prior3D
functions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Biodiversity distribution data in 2D raster form</span></span>
<span><span class="va">depth_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_depth_raster.html">get_depth_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">depth_raster</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 31, 83, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.5, 0.5  (x, y)</span></span>
<span><span class="co">## extent      : -5.5, 36, 30.5, 46  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">## source      : depth_raster.tif </span></span>
<span><span class="co">## name        : depth_raster </span></span>
<span><span class="co">## min value   :  -4082.70312 </span></span>
<span><span class="co">## max value   :     -6.60191</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-by-step-3d-scp-analysis">4 <strong>Step-by-Step 3D SCP analysis</strong><a class="anchor" aria-label="anchor" href="#step-by-step-3d-scp-analysis"></a>
</h2>
<div class="section level3">
<h3 id="step-1-data-preparation">4.1 <strong>Step 1: Data Preparation</strong><a class="anchor" aria-label="anchor" href="#step-1-data-preparation"></a>
</h3>
<p><strong>Transforming Biodiversity Distributions into Multilevel (3D)
Data</strong></p>
<p>The <code><a href="../reference/split_rast.html">split_rast()</a></code> function is used to convert 2D
distributions of biodiversity features (rasters) into a 3D format.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Splitting features' 2D distributions into 3D ones</span></span>
<span><span class="va">split_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/split_rast.html">split_rast</a></span><span class="op">(</span><span class="va">biodiv_raster</span>,</span>
<span>                             <span class="va">depth_raster</span>,</span>
<span>                             breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">2000</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                             <span class="va">biodiv_df</span>,</span>
<span>                             val_depth_range<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The output is a list containing species distributions for each
bathymetric layer, necessary for the analysis next steps.</p>
</div>
<div class="section level3">
<h3 id="step-2-3d-prioritization-algorithm">4.2 <strong>Step 2: 3D Prioritization Algorithm</strong><a class="anchor" aria-label="anchor" href="#step-2-3d-prioritization-algorithm"></a>
</h3>
<p>The 3D prioritization algorithm is implemented using the
<code><a href="../reference/prioritize_3D.html">prioritize_3D()</a></code> function, the core function of the
<strong>prior3D</strong> package. This function uses the list generated
from the <code><a href="../reference/split_rast.html">split_rast()</a></code> function and other necessary
inputs.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single_3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prioritize_3D.html">prioritize_3D</a></span><span class="op">(</span>split_features  <span class="op">=</span> <span class="va">split_features</span>,</span>
<span>                           depth_raster    <span class="op">=</span> <span class="va">depth_raster</span>,</span>
<span>                           breaks          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">2000</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                           biodiv_df       <span class="op">=</span> <span class="va">biodiv_df</span>,</span>
<span>                           budget_percents <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                           budget_weights  <span class="op">=</span> <span class="st">"richness"</span>,</span>
<span>                           threads         <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                           portfolio       <span class="op">=</span> <span class="st">"gap"</span>,</span>
<span>                           portfolio_opts  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Budget: 0.3</span></span></code></pre></div>
<p><u>Notes:</u></p>
<p><code>budget_percent</code>: Contrarily to its strict economic
definition, budget reflects the desired level of protection to be
modeled. It ranges from 0 to 1, with 0 indicating no resources available
for protection, while 1 signifies resources sufficient to protect the
entire study area. Typically, setting a budget of 0.3 corresponds to the
30% conservation target (i.e. 30% of the total area set aside for
conservation). Users also have the flexibility to define multiple budget
levels using a vector, allowing for the exploration of various
protection scenarios. For instance, a vector like
<code>c(0.1, 0.3, 0.5)</code> represents three scenarios where 10%, 30%,
and 50% of the study area are designated for protection.</p>
<p><code>budget_weights</code>: The <code><a href="../reference/prioritize_3D.html">prioritize_3D()</a></code>
function allows users to specify how the budget is distributed among
depth levels. Three allocation methods are available:</p>
<ol style="list-style-type: decimal">
<li><p>Equal Distribution: Allocates an equal share of the budget to
each depth level (<code>budget_weights ="equal"</code>).</p></li>
<li><p>Proportional to Area: Allocates budget based on the spatial
extent of each depth level
(<code>budget_weights ="area"</code>).</p></li>
<li><p>Proportional to Species Richness: Prioritizes budget allocation
to depth levels with higher species diversity (number of species).
(<code>budget_weights = "richness"</code>)</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="step-3-generating-outputs">4.3 <strong>Step 3: Generating Outputs</strong><a class="anchor" aria-label="anchor" href="#step-3-generating-outputs"></a>
</h3>
<p><strong>Prioritization Maps</strong></p>
<p>The <code><a href="../reference/prioritize_3D.html">prioritize_3D()</a></code> function is used to generate
prioritization maps. Single budget settings (ex.
<code>total_budget=0.3</code>) produce standard maps, as typical Marxan
outputs. Multiple budgets, by using a vector (ex.
<code>c(0.1,0.3,0.5)</code>, indicating available resources sufficient
to protect 10%, 30% and 50% of the area) result in cumulative maps,
illustrating areas selected by various budget levels. Although this
output follows a different approach, it resembles to typical Zonation
output maps.</p>
<p align="center">
<img src="fig3.jpg" alt="Figure 3: Prioritization maps for single and multiple budget percentages" width="100%" style="display: block; margin: auto;"></p>
<p class="caption" align="center">
<span id="fig-Figure3"></span>Figure 3: Prioritization maps for single
and multiple budget percentages
</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create plot of outputs for a single budget percentage</span></span>
<span><span class="fu"><a href="../reference/plot_3D.html">plot_3D</a></span><span class="op">(</span><span class="va">single_3D</span>, to_plot<span class="op">=</span><span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="fig4.jpg" alt="Figure 4: Output for 30% budget percentage" width="60%"></p>
<p class="caption" align="center">
<span id="fig-Figure4"></span>Figure 4: Output for 30% budget percentage
</p>
<p>And for multiple budgets</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create plot of outputs for multiple budget percentages</span></span>
<span><span class="va">multuple_3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prioritize_3D.html">prioritize_3D</a></span><span class="op">(</span>split_features  <span class="op">=</span> <span class="va">split_features</span>,</span>
<span>                             depth_raster    <span class="op">=</span> <span class="va">depth_raster</span>,</span>
<span>                             breaks          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">2000</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                             biodiv_df       <span class="op">=</span> <span class="va">biodiv_df</span>,</span>
<span>                             budget_percents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                             budget_weights  <span class="op">=</span> <span class="st">"richness"</span>,</span>
<span>                             threads         <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                             portfolio       <span class="op">=</span> <span class="st">"gap"</span>,</span>
<span>                             portfolio_opts  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Budget: 0</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Budget: 0.1</span></span>
<span><span class="co">## Budget: 0.2</span></span>
<span><span class="co">## Budget: 0.3</span></span>
<span><span class="co">## Budget: 0.4</span></span>
<span><span class="co">## Budget: 0.5</span></span>
<span><span class="co">## Budget: 0.6</span></span>
<span><span class="co">## Budget: 0.7</span></span>
<span><span class="co">## Budget: 0.8</span></span>
<span><span class="co">## Budget: 0.9</span></span>
<span><span class="co">## Budget: 1</span></span>
<span><span class="co">## Warning: Problem failed presolve checks.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## These checks indicate that solutions might not identify meaningful priority</span></span>
<span><span class="co">## areas:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ✖ Budget is greater than the total cost of selecting all planning units.</span></span>
<span><span class="co">## → Maybe you made a mistake when setting the `budget` in the objective function?</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ For more information, see `presolve_check()`.</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_3D.html">plot_3D</a></span><span class="op">(</span><span class="va">multuple_3D</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="fig5.jpg" alt="Figure 5: Output for multiple budget percentages" width="75%"></p>
<p class="caption" align="center">
<span id="fig-Figure5"></span>Figure 5: Output for multiple budget
percentages
</p>
</div>
</div>
<div class="section level2">
<h2 id="comparative-analysis-of-a-2d-and-a-3d-scp-approach">5 <strong>Comparative Analysis of a 2D and a 3D SCP
approach</strong><a class="anchor" aria-label="anchor" href="#comparative-analysis-of-a-2d-and-a-3d-scp-approach"></a>
</h2>
<p>To facilitate comparisons between 3D and 2D approaches, the
<code>compare_2D_3D()</code> function is provided in the package. This
function enables users to conduct all the above mentioned steps of
analysis (data generation, setting and solving the optimization problem
and producing outputs), by executing both 2D and 3D approaches, with
similar settings, that facilitate comparisons. The function
<code><a href="../reference/plot_Compare_2D_3D.html">plot_Compare_2D_3D()</a></code> generates corresponding maps and
graphs for both approaches.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_2D_3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Compare_2D_3D.html">Compare_2D_3D</a></span><span class="op">(</span>biodiv_raster   <span class="op">=</span> <span class="va">biodiv_raster</span>,</span>
<span>                           depth_raster    <span class="op">=</span> <span class="va">depth_raster</span>,</span>
<span>                           breaks          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">2000</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                           biodiv_df       <span class="op">=</span> <span class="va">biodiv_df</span>,</span>
<span>                           budget_percents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                           budget_weights  <span class="op">=</span> <span class="st">"richness"</span>,</span>
<span>                           threads         <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                           portfolio       <span class="op">=</span> <span class="st">"gap"</span>, <span class="co">#"shuffle"</span></span>
<span>                           portfolio_opts  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Budget: 0</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Warning: Portfolio could only find 1 out of 10 solutions.</span></span>
<span><span class="co">## Budget: 0.1</span></span>
<span><span class="co">## Budget: 0.2</span></span>
<span><span class="co">## Budget: 0.3</span></span>
<span><span class="co">## Budget: 0.4</span></span>
<span><span class="co">## Budget: 0.5</span></span>
<span><span class="co">## Budget: 0.6</span></span>
<span><span class="co">## Budget: 0.7</span></span>
<span><span class="co">## Budget: 0.8</span></span>
<span><span class="co">## Budget: 0.9</span></span>
<span><span class="co">## Budget: 1</span></span>
<span><span class="co">## Warning: Problem failed presolve checks.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## These checks indicate that solutions might not identify meaningful priority</span></span>
<span><span class="co">## areas:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ✖ Budget is greater than the total cost of selecting all planning units.</span></span>
<span><span class="co">## → Maybe you made a mistake when setting the `budget` in the objective function?</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ For more information, see `presolve_check()`.</span></span>
<span><span class="co">## Warning: Problem failed presolve checks.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## These checks indicate that solutions might not identify meaningful priority</span></span>
<span><span class="co">## areas:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ✖ Budget is greater than the total cost of selecting all planning units.</span></span>
<span><span class="co">## → Maybe you made a mistake when setting the `budget` in the objective function?</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ For more information, see `presolve_check()`.</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_Compare_2D_3D.html">plot_Compare_2D_3D</a></span><span class="op">(</span><span class="va">out_2D_3D</span>, to_plot<span class="op">=</span><span class="st">"all"</span>, add_lines<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="fig6.jpg" alt="Figure 6: Comparison of 2D vs 3D approach for multiple budget
  percentages" width="75%"></p>
<p class="caption" align="center">
<span id="fig-Figure6"></span>Figure 6: Comparison of 2D vs 3D approach
for multiple budget percentages
</p>
</div>
<div class="section level2">
<h2 id="spatial-coherence-metrics">6 <strong>Spatial Coherence Metrics</strong><a class="anchor" aria-label="anchor" href="#spatial-coherence-metrics"></a>
</h2>
<p>The spatial coherence of the prioritization output (optimization
solution) maps is assessed using three metrics: average surface
roughness (SA), surface kurtosis (SKU), and the RAO index. These can be
used for comparison among solution 2D and 3D solutions.</p>
<p>High SA values signify that there is a high spatial heterogeneity,
indicating lower spatial coherence. High SKU indicate high spatial
coherence. Both SA and SKU are calculated using R package
<strong>geodiv</strong> (<a href="#ref-geodiv">Smith et al. 2023</a>),
applying <code><a href="https://rdrr.io/pkg/geodiv/man/focal_metrics.html" class="external-link">geodiv::focal_metrics</a></code> functions “sa” and “sku” to
optimization solution rasters.</p>
<p>High RAO values suggest increased spatial heterogeneity, thus low
spatial coherence. To compute the RAO metric, a moving window approach
is employed on optimization solution maps, using function
<code><a href="https://mattmar.github.io/rasterdiv/reference/paRao.html" class="external-link">rasterdiv::paRao</a></code> from R package <strong>rasterdiv</strong>
(<a href="#ref-rasterdiv">Rocchini, Thouverai, et al. 2021</a>; <a href="#ref-rasterdivpaper">Rocchini, Marcantonio, et al. 2021</a>). The
dimensions of the window chosen is 3×3. The new raster, which is a
result of the application of the algorithm, is used to get an average
RAO value for the whole raster.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coherence.html">coherence</a></span><span class="op">(</span><span class="va">out_2D_3D</span>, w<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Progress metrics:  1 / 1</span></span>
<span><span class="co">## Progress metrics:  1 / 1</span></span>
<span><span class="co">##  sa2D  sa3D sa2Dw sa3Dw </span></span>
<span><span class="co">## 3.806 3.503 2.413 2.118 </span></span></code></pre></div>
<p align="center">
<img src="sa.jpg" alt="Figure 7: SA" width="75%"></p>
<p class="caption" align="center">
<span id="fig-Figure7"></span>Figure 7: SA
</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coherence.html">coherence</a></span><span class="op">(</span><span class="va">out_2D_3D</span>, w<span class="op">=</span><span class="fl">3</span>, metric<span class="op">=</span><span class="st">"sku"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Progress metrics:  1 / 1</span></span>
<span><span class="co">## Progress metrics:  1 / 1</span></span>
<span><span class="co">## sku2D  sku3D sku2Dw sku3Dw </span></span>
<span><span class="co">## 0.347  1.138 -0.536 -0.374 </span></span></code></pre></div>
<p align="center">
<img src="sku.jpg" alt="Figure 8: SKU" width="75%"></p>
<p class="caption" align="center">
<span id="fig-Figure8"></span>Figure 8: SKU
</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coherence.html">coherence</a></span><span class="op">(</span><span class="va">out_2D_3D</span>, w<span class="op">=</span><span class="fl">3</span>, metric<span class="op">=</span><span class="st">"rao"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 2D RAO</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Processing alpha: 1 Moving Window: 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Processing alpha: 1 Moving Window: 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [============================&gt;----------------]  64% in  0s</span></span>
<span><span class="co">## [============================&gt;----------------]  65% in  0s</span></span>
<span><span class="co">## [=============================&gt;---------------]  66% in  0s</span></span>
<span><span class="co">## [=============================&gt;---------------]  67% in  0s</span></span>
<span><span class="co">## [==============================&gt;--------------]  69% in  0s</span></span>
<span><span class="co">## [==============================&gt;--------------]  70% in  0s</span></span>
<span><span class="co">## [===============================&gt;-------------]  71% in  0s</span></span>
<span><span class="co">## [================================&gt;------------]  72% in  0s</span></span>
<span><span class="co">## [================================&gt;------------]  73% in  0s</span></span>
<span><span class="co">## [=================================&gt;-----------]  75% in  0s</span></span>
<span><span class="co">## [=================================&gt;-----------]  76% in  0s</span></span>
<span><span class="co">## [==================================&gt;----------]  77% in  0s</span></span>
<span><span class="co">## [==================================&gt;----------]  78% in  0s</span></span>
<span><span class="co">## [===================================&gt;---------]  80% in  0s</span></span>
<span><span class="co">## [===================================&gt;---------]  81% in  0s</span></span>
<span><span class="co">## [====================================&gt;--------]  82% in  0s</span></span>
<span><span class="co">## [====================================&gt;--------]  83% in  0s</span></span>
<span><span class="co">## [=====================================&gt;-------]  84% in  0s</span></span>
<span><span class="co">## [=====================================&gt;-------]  86% in  0s</span></span>
<span><span class="co">## [======================================&gt;------]  87% in  0s</span></span>
<span><span class="co">## [=======================================&gt;-----]  88% in  0s</span></span>
<span><span class="co">## [=======================================&gt;-----]  89% in  0s</span></span>
<span><span class="co">## [========================================&gt;----]  90% in  0s</span></span>
<span><span class="co">## [========================================&gt;----]  92% in  0s</span></span>
<span><span class="co">## [=========================================&gt;---]  93% in  0s</span></span>
<span><span class="co">## [=========================================&gt;---]  94% in  0s</span></span>
<span><span class="co">## [==========================================&gt;--]  95% in  0s</span></span>
<span><span class="co">## [==========================================&gt;--]  96% in  0s</span></span>
<span><span class="co">## [===========================================&gt;-]  98% in  0s</span></span>
<span><span class="co">## [===========================================&gt;-]  99% in  0s</span></span>
<span><span class="co">## [=============================================] 100% in  0s</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 3D RAO</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Processing alpha: 1 Moving Window: 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Processing alpha: 1 Moving Window: 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [=============================&gt;---------------]  67% in  0s</span></span>
<span><span class="co">## [==============================&gt;--------------]  69% in  0s</span></span>
<span><span class="co">## [==============================&gt;--------------]  70% in  0s</span></span>
<span><span class="co">## [===============================&gt;-------------]  71% in  0s</span></span>
<span><span class="co">## [================================&gt;------------]  72% in  0s</span></span>
<span><span class="co">## [================================&gt;------------]  73% in  0s</span></span>
<span><span class="co">## [=================================&gt;-----------]  75% in  0s</span></span>
<span><span class="co">## [=================================&gt;-----------]  76% in  0s</span></span>
<span><span class="co">## [==================================&gt;----------]  77% in  0s</span></span>
<span><span class="co">## [==================================&gt;----------]  78% in  0s</span></span>
<span><span class="co">## [===================================&gt;---------]  80% in  0s</span></span>
<span><span class="co">## [===================================&gt;---------]  81% in  0s</span></span>
<span><span class="co">## [====================================&gt;--------]  82% in  0s</span></span>
<span><span class="co">## [====================================&gt;--------]  83% in  0s</span></span>
<span><span class="co">## [=====================================&gt;-------]  84% in  0s</span></span>
<span><span class="co">## [=====================================&gt;-------]  86% in  0s</span></span>
<span><span class="co">## [======================================&gt;------]  87% in  0s</span></span>
<span><span class="co">## [=======================================&gt;-----]  88% in  0s</span></span>
<span><span class="co">## [=======================================&gt;-----]  89% in  0s</span></span>
<span><span class="co">## [========================================&gt;----]  90% in  0s</span></span>
<span><span class="co">## [========================================&gt;----]  92% in  0s</span></span>
<span><span class="co">## [=========================================&gt;---]  93% in  0s</span></span>
<span><span class="co">## [=========================================&gt;---]  94% in  0s</span></span>
<span><span class="co">## [==========================================&gt;--]  95% in  0s</span></span>
<span><span class="co">## [==========================================&gt;--]  96% in  0s</span></span>
<span><span class="co">## [===========================================&gt;-]  98% in  0s</span></span>
<span><span class="co">## [===========================================&gt;-]  99% in  0s</span></span>
<span><span class="co">## [=============================================] 100% in  0s</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rao2D.mean</span></span>
<span><span class="co">## [1] 1.872</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rao3D.mean</span></span>
<span><span class="co">## [1] 1.709</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Warning messages:</span></span>
<span><span class="co">## 1: In rasterdiv::paRao(x = raster_data_2D, window = w, na.tolerance = 1,  :</span></span>
<span><span class="co">##   Simplify=0. Rounding data to 0 decimal places.</span></span>
<span><span class="co">## 2: In rasterdiv::paRao(x = raster_data_2D, window = w, na.tolerance = 1,  :</span></span>
<span><span class="co">##   Input data are float numbers. Converting data to integer matrices.</span></span>
<span><span class="co">## 3: In rasterdiv::paRao(x = raster_data_3D, window = w, na.tolerance = 1,  :</span></span>
<span><span class="co">##   Simplify=0. Rounding data to 0 decimal places.</span></span>
<span><span class="co">## 4: In rasterdiv::paRao(x = raster_data_3D, window = w, na.tolerance = 1,  :</span></span>
<span><span class="co">##   Input data are float numbers. Converting data to integer matrices.</span></span></code></pre></div>
<p align="center">
<img src="rao.jpg" alt="Figure 9: RAO" width="75%"></p>
<p class="caption" align="center">
<span id="fig-Figure9"></span>Figure 9: RAO
</p>
</div>
<div class="section level2">
<h2 id="references">7 <strong>References</strong><a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Doxa, Aggeliki, Vasiliki Almpanidou, Stelios Katsanevakis, Ana M
Queirós, Kristin Kaschner, Cristina Garilao, Kathleen Kesner-Reyes, and
Antonios D Mazaris. 2022. “<span id="ref-doxa20224d" class="nocase">4D
marine conservation networks: Combining 3D prioritization of present and
future biodiversity with climatic refugia</span>. <em>Global Change
Biology</em> 28 (15): 4577–88. <a href="https://doi.org/10.1111/gcb.16268" class="external-link uri">https://doi.org/10.1111/gcb.16268</a>.</p>
<p>Hanson, Jeffrey O, Richard Schuster, Nina Morrell, Matthew
Strimas-Mackey, Brandon P M Edwards, Matthew E Watts, Peter Arcese,
Joseph Bennett, and Hugh P Possingham. 2024. <em><span id="ref-prioritizr" class="nocase">prioritizr: Systematic Conservation
Prioritization in R</span></em>. <a href="https://prioritizr.net" class="external-link uri">https://prioritizr.net</a>.</p>
<p>Rocchini, Duccio, Matteo Marcantonio, Daniele Da Re, Giovanni Bacaro,
Enrico Feoli, Giles Foody, Reinhard Furrer, et al. 2021. “<span id="ref-rasterdivpaper" class="nocase">From zero to infinity: Minimum to
maximum diversity of the planet by spatio-parametric Rao’s quadratic
entropy</span>.<em>Global Ecology and Biogeography</em> 30 (5): 2315. <a href="https://doi.org/10.1111/geb.13270" class="external-link uri">https://doi.org/10.1111/geb.13270</a>.</p>
<p>Rocchini, Duccio, Elisa Thouverai, Matteo Marcantonio, Martina
Iannacito, Daniele Da Re, Michele Torresani, Giovanni Bacaro, et al.
2021. “<span id="ref-rasterdiv" class="nocase"> rasterdiv - An
Information Theory tailored R package for measuring ecosystem
heterogeneity from space: To the origin and back</span>.” <em>Methods in
Ecology and Evolution</em> 12 (6): 2195. <a href="https://doi.org/10.1111/2041-210X.13583" class="external-link uri">https://doi.org/10.1111/2041-210X.13583</a>.</p>
<p>Smith, Annie C., Phoebe Zarnetske, Kyla Dahlin, Adam Wilson, and
Andrew Latimer. 2023. <span id="ref-geodiv" class="nocase"></span><em>Geodiv: Methods for Calculating Gradient
Surface Metrics</em>. <a href="https://doi.org/10.32614/CRAN.package.geodiv" class="external-link uri">https://doi.org/10.32614/CRAN.package.geodiv</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aggeliki Doxa, Christos Adam, Nikolaos Nagkoulis, Antonios D. Mazaris, Stelios Katsanevakis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
